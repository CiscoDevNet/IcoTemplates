[{"Body":{"ClassId":"workflow.TaskDefinition","DefaultVersion":true,"Label":"Sleep Task","Name":"InvokeSleepTask","ObjectType":"workflow.TaskDefinition","Properties":{"ExternalMeta":true,"InputDefinition":[{"Default":{"ObjectType":"workflow.DefaultValue"},"DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Sleep Time in Seconds","Name":"SleepTimeInSec","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"Max":600,"Min":1,"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"integer"},"Required":true}],"ObjectType":"workflow.Properties","OutputDefinition":[],"RetryCount":3,"RetryDelay":60,"RetryPolicy":"Fixed","SupportStatus":"Supported","Timeout":600,"TimeoutPolicy":"Timeout"},"RollbackTasks":[],"SharedScope":"shared","Tags":[{"Key":"category","Value":"CoreTasks"}],"Version":1},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/TaskDefinitions","Verb":"POST"},{"Body":{"ClassId":"workflow.TaskDefinition","DefaultVersion":true,"Description":"Fetches the Workspace ID, Organization Name and other configuration for the given Workspace","Label":"Get Terraform Workspace Details","Name":"GetTerraformWorkspaceDetails","ObjectType":"workflow.TaskDefinition","Properties":{"ExternalMeta":true,"InputDefinition":[{"CustomDataTypeProperties":{"CatalogMoid":"shared","ObjectType":"workflow.CustomDataProperty"},"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Terraform Cloud Target","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Terraform target Type","Name":"TerraformCloudTarget","ObjectType":"workflow.TargetDataType","Properties":[{"DisplayAttributes":["Name","TargetType"],"ObjectType":"workflow.TargetProperty","Selector":"/api/v1/asset/Targets?$filter=(TargetType eq TerraformCloud and Status eq Connected)","SelectorProperty":{"Method":"GET","ObjectType":"workflow.SelectorProperty"}}],"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Name of the Terraform Organization","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Terraform Organization Name","Name":"TerraformOrganizationName","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[{"DisplayAttributes":["Name","Identity"],"ObjectType":"workflow.MoReferenceProperty","Selector":"/api/v1/cloud/TfcOrganizations","SelectorProperty":{"Method":"GET","ObjectType":"workflow.SelectorProperty"},"ValueAttribute":"Name"}],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Name of the Terraform Workspace","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Terraform Workspace Name","Name":"TerraformWorkspaceName","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[{"DisplayAttributes":["Name","Identity","Organization.Name"],"ObjectType":"workflow.MoReferenceProperty","Selector":"/api/v1/cloud/TfcWorkspaces?$expand=Organization","SelectorProperty":{"Method":"GET","ObjectType":"workflow.SelectorProperty"},"ValueAttribute":"Name"}],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true}],"ObjectType":"workflow.Properties","OutputDefinition":[{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Organization Name","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Organization Name","Name":"OrganizationName","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Workspace Name","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Workspace Name","Name":"WorkspaceName","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Identity of the Terraform Workspace","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Workspace ID","Name":"WorkspaceId","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Apply Method configured in the Workspace","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Workspace Auto Apply","Name":"WorkspaceAutoApply","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"boolean"},"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Apply Method configured in the Workspace","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Apply Method","Name":"ApplyMethod","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Identity of the agent pool associated with the Workspace","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Agent Pool ID","Name":"AgentPoolId","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Name of the agent pool associated with the Workspace","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Agent Pool Name","Name":"AgentPoolName","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Execution mode configured in the workspace","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Execution Mode Configured","Name":"ExecutionMode","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"User Interface configuration of the Workspace","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"User Interface","Name":"UserInterface","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true}],"RetryDelay":60,"RetryPolicy":"Fixed","SupportStatus":"Supported","Timeout":600,"TimeoutPolicy":"Timeout"},"RollbackTasks":[],"SharedScope":"shared","Tags":[{"Key":"category","Value":"Terraform Cloud"}],"Version":1},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/TaskDefinitions","Verb":"POST"},{"Body":{"ClassId":"workflow.TaskDefinition","DefaultVersion":true,"Description":"Starts a new plan or destroys a plan in the given Terraform Workspace","Label":"Start New Terraform Plan","Name":"StartNewTerraformPlan","ObjectType":"workflow.TaskDefinition","Properties":{"ExternalMeta":true,"InputDefinition":[{"CustomDataTypeProperties":{"CatalogMoid":"shared","ObjectType":"workflow.CustomDataProperty"},"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Terraform Cloud Target","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Terraform Cloud Target","Name":"TerraformCloudTarget","ObjectType":"workflow.TargetDataType","Properties":[{"DisplayAttributes":["Name","TargetType"],"ObjectType":"workflow.TargetProperty","Selector":"/api/v1/asset/Targets?$filter=(TargetType eq TerraformCloud and Status eq Connected)","SelectorProperty":{"Method":"GET","ObjectType":"workflow.SelectorProperty"}}],"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Identity of the Terraform Workspace","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Workspace ID","Name":"WorkspaceId","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Reason for starting the plan","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Reason for starting plan","Name":"ReasonForStartingPlan","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"}},{"Default":{"ObjectType":"workflow.DefaultValue","Override":true,"Value":"false"},"Description":"Action of the plan - new plan / destroy plan","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Plan Operation","Name":"PlanOperation","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[{"Label":"new plan","ObjectType":"workflow.EnumEntry","Value":"false"},{"Label":"destroy","ObjectType":"workflow.EnumEntry","Value":"true"}],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"enum"}}],"ObjectType":"workflow.Properties","OutputDefinition":[{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Identity of the triggered Run","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Run ID","Name":"RunId","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true}],"RetryDelay":60,"RetryPolicy":"Fixed","SupportStatus":"Supported","Timeout":600,"TimeoutPolicy":"Timeout"},"RollbackTasks":[],"SharedScope":"shared","Tags":[{"Key":"category","Value":"Terraform Cloud"}],"Version":1},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/TaskDefinitions","Verb":"POST"},{"Body":{"ClassId":"workflow.WorkflowDefinition","DefaultVersion":true,"Description":"Starts a plan in the terraform workspace","InputDefinition":[{"CustomDataTypeProperties":{"CatalogMoid":"shared","ObjectType":"workflow.CustomDataProperty"},"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Terraform Cloud Target","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Terraform Cloud Target","Name":"TerraformCloudTarget","ObjectType":"workflow.TargetDataType","Properties":[{"DisplayAttributes":["Name","TargetType"],"ObjectType":"workflow.TargetProperty","Selector":"/api/v1/asset/Targets?$filter=(TargetType eq TerraformCloud and Status eq Connected)","SelectorProperty":{"Method":"GET","ObjectType":"workflow.SelectorProperty"}}],"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Name of the Terraform Organization","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Terraform Organization Name","Name":"TerraformOrganizationName","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[{"DisplayAttributes":["Name","Identity"],"ObjectType":"workflow.MoReferenceProperty","Selector":"/api/v1/cloud/TfcOrganizations","SelectorProperty":{"Method":"GET","ObjectType":"workflow.SelectorProperty"},"ValueAttribute":"Name"}],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Name of the Terraform Workspace","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Terraform Workspace Name","Name":"TerraformWorkspaceName","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[{"DisplayAttributes":["Name","Identity"],"ObjectType":"workflow.MoReferenceProperty","Selector":"/api/v1/cloud/TfcWorkspaces","SelectorProperty":{"Method":"GET","ObjectType":"workflow.SelectorProperty"},"ValueAttribute":"Name"}],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Reason for starting a new plan","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Reason for starting plan","Name":"ReasonForStartingPlan","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"}},{"Default":{"ObjectType":"workflow.DefaultValue","Override":true,"Value":"false"},"Description":"Action of the plan - new plan / destroy plan","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Plan Operation","Name":"PlanOperation","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[{"Label":"new plan","ObjectType":"workflow.EnumEntry","Value":"false"},{"Label":"destroy","ObjectType":"workflow.EnumEntry","Value":"true"}],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"enum"}}],"InputParameterSet":[],"Label":"Start New Terraform Plan","Name":"StartNewTerraformPlan","ObjectType":"workflow.WorkflowDefinition","OutputDefinition":[{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Organization Name","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Organization Name","Name":"OrganizationName","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Workspace Name","Name":"WorkspaceName","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Identity of the Terraform Workspace","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Workspace ID","Name":"WorkspaceId","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Identity of the triggered Run","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Run ID","Name":"RunId","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true}],"OutputParameters":{"OrganizationName":"{{.global.workflow.input.TerraformOrganizationName}}","RunId":"{{.global.StartNewPlan.output.RunId}}","WorkspaceId":"{{.global.GetWorkspaceDetails.output.WorkspaceId}}","WorkspaceName":"{{.global.workflow.input.TerraformWorkspaceName}}"},"Properties":{"ExternalMeta":true,"ObjectType":"workflow.WorkflowProperties","SupportStatus":"Supported"},"SharedScope":"shared","Tags":[{"Key":"category","Value":"Terraform Cloud"}],"Tasks":[{"Name":"StartTask","NextTask":"GetWorkspaceDetails","ObjectType":"workflow.StartTask"},{"CatalogMoid":"shared","Description":"Fetches the Workspace ID and AutoApply config for the given Name","InputParameters":{"TerraformCloudTarget":"${workflow.input.TerraformCloudTarget}","TerraformOrganizationName":"${workflow.input.TerraformOrganizationName}","TerraformWorkspaceName":"${workflow.input.TerraformWorkspaceName}"},"Label":"Get Workspace Details","Name":"GetWorkspaceDetails","ObjectType":"workflow.WorkerTask","OnSuccess":"StartNewPlan","TaskDefinitionName":"GetTerraformWorkspaceDetails","Version":1},{"CatalogMoid":"shared","Description":"Starts a new plan with the operation requested by the user","InputParameters":{"PlanOperation":"${workflow.input.PlanOperation}","ReasonForStartingPlan":"${workflow.input.ReasonForStartingPlan}","TerraformCloudTarget":"${workflow.input.TerraformCloudTarget}","WorkspaceId":"{{.global.GetWorkspaceDetails.output.WorkspaceId}}"},"Label":"Start New Plan","Name":"StartNewPlan","ObjectType":"workflow.WorkerTask","OnSuccess":"SuccessEndTask","TaskDefinitionName":"StartNewTerraformPlan","Version":1},{"Name":"SuccessEndTask","ObjectType":"workflow.SuccessEndTask"},{"Name":"FailureEndTask","ObjectType":"workflow.FailureEndTask"}],"UiInputFilters":[{"Filters":["Organization.Moid eq '${TerraformOrganizationName.Moid}'"],"Name":"TerraformWorkspaceName","ObjectType":"workflow.UiInputFilter","UserHelpMessage":"Select 'Terraform Organization Name' before selecting 'Terraform Workspace Name'"}],"Version":1},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/WorkflowDefinitions","Verb":"POST"},{"Body":{"ClassId":"workflow.TaskDefinition","DefaultVersion":true,"Description":"Get Run Id in Confirmed State","Label":"Get Terraform Confirmed Run ID","Name":"GetTerraformConfirmedRunId","ObjectType":"workflow.TaskDefinition","Properties":{"InputDefinition":[{"CustomDataTypeProperties":{"CatalogMoid":"shared","ObjectType":"workflow.CustomDataProperty"},"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Terraform Cloud Target","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Terraform Cloud Target","Name":"TerraformCloudTarget","ObjectType":"workflow.TargetDataType","Properties":[{"DisplayAttributes":["Name","TargetType"],"ObjectType":"workflow.TargetProperty","Selector":"/api/v1/asset/Targets?$filter=(TargetType eq TerraformCloud and Status eq Connected)","SelectorProperty":{"Method":"GET","ObjectType":"workflow.SelectorProperty"}}],"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Identity of the Terraform Workspace","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Workspace ID","Name":"WorkspaceId","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true}],"ObjectType":"workflow.Properties","OutputDefinition":[{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Identity of the Run which is in one of \"Planned\" / \"Cost Estimated\" / \"Policy Checked\" state.","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Run ID","Name":"RunId","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"}}],"RetryDelay":60,"RetryPolicy":"Fixed","SupportStatus":"Supported","Timeout":600,"TimeoutPolicy":"Timeout"},"RollbackTasks":[],"SharedScope":"shared","Tags":[{"Key":"category","Value":"Terraform Cloud"}],"Version":1},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/TaskDefinitions","Verb":"POST"},{"Body":{"ClassId":"workflow.TaskDefinition","DefaultVersion":true,"Description":"Get the latest Run Id in the workspace","Label":"Get Latest Run ID","Name":"GetTerraformLatestRunId","ObjectType":"workflow.TaskDefinition","Properties":{"InputDefinition":[{"CustomDataTypeProperties":{"CatalogMoid":"shared","ObjectType":"workflow.CustomDataProperty"},"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Terraform Cloud Target","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Terraform Cloud Target","Name":"TerraformCloudTarget","ObjectType":"workflow.TargetDataType","Properties":[{"DisplayAttributes":["Name","TargetType"],"ObjectType":"workflow.TargetProperty","Selector":"/api/v1/asset/Targets?$filter=(TargetType eq TerraformCloud and Status eq Connected)","SelectorProperty":{"Method":"GET","ObjectType":"workflow.SelectorProperty"}}],"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Identity of the Terraform Workspace","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Workspace ID","Name":"WorkspaceId","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true}],"ObjectType":"workflow.Properties","OutputDefinition":[{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Identity of the latest Run","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Run Id","Name":"RunId","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"}}],"RetryDelay":60,"RetryPolicy":"Fixed","SupportStatus":"Supported","Timeout":600,"TimeoutPolicy":"Timeout"},"RollbackTasks":[],"SharedScope":"shared","Tags":[{"Key":"category","Value":"Terraform Cloud"}],"Version":1},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/TaskDefinitions","Verb":"POST"},{"Body":{"ClassId":"workflow.TaskDefinition","DefaultVersion":true,"Description":"Executing terraform apply run","Label":"Confirm and Apply Terraform Run","Name":"ConfirmTerraformRun","ObjectType":"workflow.TaskDefinition","Properties":{"ExternalMeta":true,"InputDefinition":[{"CustomDataTypeProperties":{"CatalogMoid":"shared","ObjectType":"workflow.CustomDataProperty"},"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Terraform Cloud Target","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Terraform Cloud Target","Name":"TerraformCloudTarget","ObjectType":"workflow.TargetDataType","Properties":[{"DisplayAttributes":["Name","TargetType"],"ObjectType":"workflow.TargetProperty","Selector":"/api/v1/asset/Targets?$filter=(TargetType eq TerraformCloud and Status eq Connected)","SelectorProperty":{"Method":"GET","ObjectType":"workflow.SelectorProperty"}}],"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Identity of the Run which needs confirmation","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Run ID","Name":"RunId","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true}],"ObjectType":"workflow.Properties","OutputDefinition":[],"RetryDelay":60,"RetryPolicy":"Fixed","SupportStatus":"Supported","Timeout":600,"TimeoutPolicy":"Timeout"},"RollbackTasks":[],"SharedScope":"shared","Tags":[{"Key":"category","Value":"Terraform Cloud"}],"Version":1},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/TaskDefinitions","Verb":"POST"},{"Body":{"ClassId":"workflow.TaskDefinition","DefaultVersion":true,"Description":"Monitor Terraform Run Execution State","Label":"Get Terraform Run State","Name":"GetTerraformRunState","ObjectType":"workflow.TaskDefinition","Properties":{"ExternalMeta":true,"InputDefinition":[{"CustomDataTypeProperties":{"CatalogMoid":"shared","ObjectType":"workflow.CustomDataProperty"},"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Terraform Cloud Target","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Terraform Cloud Target","Name":"TerraformCloudTarget","ObjectType":"workflow.TargetDataType","Properties":[{"DisplayAttributes":["Name","TargetType"],"ObjectType":"workflow.TargetProperty","Selector":"/api/v1/asset/Targets?$filter=(TargetType eq TerraformCloud and Status eq Connected)","SelectorProperty":{"Method":"GET","ObjectType":"workflow.SelectorProperty"}}],"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Identity of the Run whose final state needs to be fetched","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Run Id","Name":"RunId","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true}],"ObjectType":"workflow.Properties","OutputDefinition":[{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The state of the Run","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Final Run State","Name":"RunState","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"}}],"RetryCount":30,"RetryDelay":120,"RetryPolicy":"Fixed","SupportStatus":"Supported","Timeout":10,"TimeoutPolicy":"Retry"},"RollbackTasks":[],"SharedScope":"shared","Tags":[{"Key":"category","Value":"Terraform Cloud"}],"Version":1},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/TaskDefinitions","Verb":"POST"},{"Body":{"ClassId":"workflow.TaskDefinition","DefaultVersion":true,"Description":"Fetches the current state version for the workspace","Label":"Get Terraform Current State Version","Name":"GetTerraformCurrentStateVersion","ObjectType":"workflow.TaskDefinition","Properties":{"ExternalMeta":true,"InputDefinition":[{"CustomDataTypeProperties":{"CatalogMoid":"shared","ObjectType":"workflow.CustomDataProperty"},"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Terraform Cloud Target","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Terraform Cloud Target","Name":"TerraformCloudTarget","ObjectType":"workflow.TargetDataType","Properties":[{"DisplayAttributes":["Name","TargetType"],"ObjectType":"workflow.TargetProperty","Selector":"/api/v1/asset/Targets?$filter=(TargetType eq TerraformCloud and Status eq Connected)","SelectorProperty":{"Method":"GET","ObjectType":"workflow.SelectorProperty"}}],"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Identity of the Terraform Workspace","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Workspace ID","Name":"WorkspaceId","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true}],"ObjectType":"workflow.Properties","OutputDefinition":[{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Current state version of the Workspace","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Current State Version","Name":"CurrentStateVersion","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true},{"ArrayItemType":{"ObjectType":"workflow.PrimitiveArrayItem","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"}},"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Name-Value pairs of the State Outputs","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"State Version Outputs","Max":32,"Min":1,"Name":"StateVersionOutputs","ObjectType":"workflow.ArrayDataType"}],"RetryDelay":60,"RetryPolicy":"Fixed","SupportStatus":"Supported","Timeout":600,"TimeoutPolicy":"Timeout"},"RollbackTasks":[],"SharedScope":"shared","Tags":[{"Key":"category","Value":"Terraform Cloud"}],"Version":1},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/TaskDefinitions","Verb":"POST"},{"Body":{"ClassId":"workflow.CustomDataTypeDefinition","CompositeType":true,"Description":"Terraform variable type","Label":"Terraform Key Value Type","Name":"TerraformKeyValueType","ObjectType":"workflow.CustomDataTypeDefinition","ParameterSet":[],"Properties":{"ObjectType":"workflow.CustomDataTypeProperties"},"SharedScope":"shared","TypeDefinition":[{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Terraform variable key can only contain letters, numbers, underscores and hyphens","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Key","Name":"Key","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints","Regex":"^[a-zA-Z0-9_-]*$"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Value of the terraform variable","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Value","Name":"Value","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"}}]},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/CustomDataTypeDefinitions","Verb":"POST"},{"Body":{"ClassId":"workflow.CustomDataTypeDefinition","CompositeType":true,"Description":"This data type takes holds information about a formatted string.","Label":"Formatted Text","Name":"FormattedText","ObjectType":"workflow.CustomDataTypeDefinition","ParameterSet":[],"Properties":{"ObjectType":"workflow.CustomDataTypeProperties"},"SharedScope":"shared","TypeDefinition":[{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The content type of the request. Currently supports JSON and Text.\n","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Content Type","Name":"ContentType","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[{"Label":"JSON","ObjectType":"workflow.EnumEntry","Value":"json"},{"Label":"Text","ObjectType":"workflow.EnumEntry","Value":"text"}],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"enum"},"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The content of the formatted text that can spawn multiple lines.","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Text","Name":"Text","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true}]},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/CustomDataTypeDefinitions","Verb":"POST"},{"Body":{"ClassId":"workflow.CustomDataTypeDefinition","CompositeType":true,"Description":"Response parser framework supports extraction of required values from API/device responses. These responses may be of various content types such as XML, JSON, etc. The values of importance are modeled as parameters in the response parser framework.\nThe parameters can be of a scalar value type or a collection of values. A group of related parameters can be modeled as a single complex type parameter. These complex types will be very useful to extract a set of repeating group of related parameters.\nA response parser specification defines the set of parameters that need to be extracted from the content. The response parser specification allows complex type definitions to be defined for any complex parameters.","Label":"Response Parser","Name":"ResponseParserType","ObjectType":"workflow.CustomDataTypeDefinition","ParameterSet":[],"Properties":{"ObjectType":"workflow.CustomDataTypeProperties"},"SharedScope":"shared","TypeDefinition":[{"ArrayItemType":{"ObjectType":"workflow.CustomArrayItem","Properties":{"CustomDataTypeName":"ResponseParameter","ObjectType":"workflow.CustomDataProperty"}},"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The collection of parameters that need to be extracted from the API response.\n","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Parameters","Max":10,"Min":1,"Name":"Parameters","ObjectType":"workflow.ArrayDataType"}]},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/CustomDataTypeDefinitions","Verb":"POST"},{"Body":{"ClassId":"workflow.TaskDefinition","Description":"Invokes the given Web API against the given endpoint. The endpoint can be Intersight API or an external endpoint added as Target in Intersight. Please refer Supported Endpoints section in the Web API request end user documentation for the list of Intersight Targets on which Web API task can be invoked.\n","Label":"Invoke Web API Request","Name":"InvokeGenericWebApi","ObjectType":"workflow.TaskDefinition","Properties":{"ExternalMeta":true,"InputDefinition":[{"CustomDataTypeProperties":{"CatalogMoid":"shared","ObjectType":"workflow.CustomDataProperty"},"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The API call can be made to Intersight or an external endpoint added as Target. Target should be in claimed or connected state. Please refer Supported Endpoints section in the Web API request end user documentation for the list of Intersight Targets on which Web API task can be invoked. An empty value for this input indicates that the API call is made to Intersight.\n","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"External Target","Name":"Target","ObjectType":"workflow.TargetDataType","Properties":[{"DisplayAttributes":["Name","TargetType"],"ObjectType":"workflow.TargetProperty","Selector":"/api/v1/asset/Targets?$filter=((TargetType eq HTTPEndpoint and Status eq Claimed) or ((TargetType eq PureStorageFlashArray or TargetType eq HitachiVirtualStoragePlatform or TargetType eq NetAppActiveIqUnifiedManager or TargetType eq TerraformCloud or TargetType eq VmwareVcenter or TargetType eq APIC) and Status eq Connected))","SelectorProperty":{"Method":"GET","ObjectType":"workflow.SelectorProperty"},"SupportedObjects":["asset.Target"]}]},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"HTTP protocol to be used - HTTP, HTTPS. Populated implicitly by fetching the value from target task input if API endpoint is added as target within Intersight. Default value of HTTPS is set if not specified in other scenarios.\n","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Protocol","Name":"Protocol","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[{"Label":"HTTP","ObjectType":"workflow.EnumEntry","Value":"http"},{"Label":"HTTPS","ObjectType":"workflow.EnumEntry","Value":"https"}],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"enum"}},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"HTTP method to be requested on the given URL. If the value is not given, GET is used as default.\n","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Method","Name":"Method","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[{"Label":"GET","ObjectType":"workflow.EnumEntry","Value":"GET"},{"Label":"HEAD","ObjectType":"workflow.EnumEntry","Value":"HEAD"},{"Label":"POST","ObjectType":"workflow.EnumEntry","Value":"POST"},{"Label":"PUT","ObjectType":"workflow.EnumEntry","Value":"PUT"},{"Label":"PATCH","ObjectType":"workflow.EnumEntry","Value":"PATCH"},{"Label":"DELETE","ObjectType":"workflow.EnumEntry","Value":"DELETE"},{"Label":"OPTIONS","ObjectType":"workflow.EnumEntry","Value":"OPTIONS"}],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"enum"}},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Relative URL for Intersight, Device Registration and Target APIs. Does not support specifying fully qualified URL.\n","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"URL","Name":"Url","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The request headers that need to be sent in the request in key value pairs list.\n","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Headers","Name":"Headers","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"json"}},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The key value pairs given in this input will be sent in HTTP 'Cookie' header.\n","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Cookies","Name":"Cookies","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"json"}},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The type of the response. Currently supports JSON.\n","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Response Type","Name":"ContentType","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[{"Label":"JSON","ObjectType":"workflow.EnumEntry","Value":"json"}],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"enum"}},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The optional request body that is sent as part of this API request. The request body can contain golang templates that can be populated with task input parameters and previous API output parameters.\n","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Body","Name":"Body","ObjectType":"workflow.CustomDataType","Properties":{"CatalogMoid":"shared","CustomDataTypeName":"FormattedText","ObjectType":"workflow.CustomDataProperty"}},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The structure of the response parser shall provide the list of values that need to be extracted from the API response.\n","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Response Parser","Name":"ResponseParser","ObjectType":"workflow.CustomDataType","Properties":{"CatalogMoid":"shared","CustomDataTypeName":"ResponseParserType","ObjectType":"workflow.CustomDataProperty"}},{"ArrayItemType":{"ObjectType":"workflow.CustomArrayItem","Properties":{"CustomDataTypeName":"Outcome","ObjectType":"workflow.CustomDataProperty"}},"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Allows to capture the possible outcomes of this API. This is a collection of outcomes which gets evaluated in the order they are given. If an outcome condition evaluates to 'true', status of the task can be set to one of the supported types - Success, Error or no operation and also an optional task execution message can be set.\nAt the end of the outcomes list, a catchall success/fail outcome can be added with condition explicitly set as 'true'. This allows to mark the status of task execution either success or failure when none of the previous outcomes match.\nWhen no outcomes is specified, default behaviour is to mark the API execution status 'success' if obtained HTTP status code is 2xx else mark it as 'failed'.\n","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Outcomes","Max":10,"Name":"Outcomes","ObjectType":"workflow.ArrayDataType"}],"ObjectType":"workflow.Properties","OutputDefinition":[{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The response headers that are extracted from the API response.\n","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Headers","Name":"Headers","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"json"}},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The list of cookies obtained from the response in the form of key value pairs.\n","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Cookies","Name":"Cookies","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"json"}},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The HTTP status code of the Web API response.\n","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Status Code","Name":"StatusCode","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"integer"}},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The HTTP status message of the Web API response.\n","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Status Message","Name":"StatusMessage","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"}},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"The list of output parameters extracted from the response.\n","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Parameters","Name":"Parameters","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"json"}}],"RetryDelay":60,"RetryPolicy":"Fixed","SupportStatus":"Supported","Timeout":120,"TimeoutPolicy":"Timeout"},"RollbackTasks":[],"SharedScope":"shared","Tags":[{"Key":"category","Value":"Executors"}],"Version":1},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/TaskDefinitions","Verb":"POST"},{"Body":{"ClassId":"workflow.WorkflowDefinition","DefaultVersion":true,"Description":"Gets name and value of terraform state version output","InputDefinition":[{"CustomDataTypeProperties":{"CatalogMoid":"shared","ObjectType":"workflow.CustomDataProperty"},"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Terraform Cloud Target","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Terraform Cloud Target","Name":"TerraformCloudTarget","ObjectType":"workflow.TargetDataType","Properties":[{"DisplayAttributes":["Name","TargetType"],"ObjectType":"workflow.TargetProperty","Selector":"/api/v1/asset/Targets?$filter=(TargetType eq TerraformCloud and Status eq Connected)","SelectorProperty":{"Method":"GET","ObjectType":"workflow.SelectorProperty"}}],"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Terraform workspace state version outputId","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"StateVersionOutputId","Name":"StateVersionOutputId","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true}],"InputParameterSet":[],"Label":"Get Terraform State Output Name Value","Name":"GetTerraformStateOutputNameValue","ObjectType":"workflow.WorkflowDefinition","OutputDefinition":[{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Name and value of the terraform state version outputId","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Name Value Pair","Name":"NameValuePair","ObjectType":"workflow.CustomDataType","Properties":{"CatalogMoid":"shared","CustomDataTypeName":"TerraformKeyValueType","ObjectType":"workflow.CustomDataType"},"Required":true}],"OutputParameters":{"NameValuePair":{"Key":"{{.global.GetNameValue.output.Parameters.Name}}","Value":"{{.global.GetNameValue.output.Parameters.Value}}"}},"Properties":{"ObjectType":"workflow.WorkflowProperties","SupportStatus":"Supported"},"SharedScope":"shared","Tasks":[{"Name":"StartTask","NextTask":"GetNameValue","ObjectType":"workflow.StartTask"},{"CatalogMoid":"shared","Description":"Gets name and value of the state outputId","InputParameters":{"ContentType":"json","Headers":{"Content-Type":["application/vnd.api+json"]},"Method":"GET","Outcomes":[{"Condition":"{{eq .local.response.HttpStatusCode 200}}","Message":"{{.local.response.Name}} : {{.local.response.Value}}","Name":"SuccessCase","Type":"Success"},{"Condition":"{{ne .local.response.HttpStatusCode  200}}","Message":"We are unable to fetch the Name and Value for the Output \"${workflow.input.StateVersionOutputId}\" due to an unexpected error message. Do try again. \"{{.local.response.HttpStatusMsg}}.\"","Name":"FailureCase","Type":"Error"}],"Protocol":"https","ResponseParser":{"Parameters":[{"Name":"Name","Path":"$.data.attributes.name","Type":"string"},{"Name":"Value","Path":"$.data.attributes.value","Type":"string"}]},"Target":"${workflow.input.TerraformCloudTarget}","Url":"api/v2/state-version-outputs/${workflow.input.StateVersionOutputId}"},"Label":"GetNameValue","Name":"GetNameValue","ObjectType":"workflow.WorkerTask","OnFailure":"FailureEndTask","OnSuccess":"SuccessEndTask","TaskDefinitionName":"InvokeGenericWebApi","Version":1},{"Name":"SuccessEndTask","ObjectType":"workflow.SuccessEndTask"},{"Name":"FailureEndTask","ObjectType":"workflow.FailureEndTask"}],"UiInputFilters":[],"Version":1},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/WorkflowDefinitions","Verb":"POST"},{"Body":{"ClassId":"workflow.WorkflowDefinition","DefaultVersion":true,"Description":"Confirms and applies a Run waiting for confirmation for a Workspace configured with manual apply. Checks the execution state of the Run for a Workspace configured with auto apply.","InputDefinition":[{"CustomDataTypeProperties":{"CatalogMoid":"shared","ObjectType":"workflow.CustomDataProperty"},"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Terraform Cloud Target","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Terraform Cloud Target","Name":"TerraformCloudTarget","ObjectType":"workflow.TargetDataType","Properties":[{"DisplayAttributes":["Name","TargetType"],"ObjectType":"workflow.TargetProperty","Selector":"/api/v1/asset/Targets?$filter=(TargetType eq TerraformCloud and Status eq Connected)","SelectorProperty":{"Method":"GET","ObjectType":"workflow.SelectorProperty"}}],"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Name of the Terraform Organization","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Terraform Organization Name","Name":"TerraformOrganizationName","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[{"DisplayAttributes":["Name","Identity"],"ObjectType":"workflow.MoReferenceProperty","Selector":"/api/v1/cloud/TfcOrganizations","SelectorProperty":{"Method":"GET","ObjectType":"workflow.SelectorProperty"},"ValueAttribute":"Name"}],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Name of the Terraform Workspace","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Terraform Workspace Name","Name":"TerraformWorkspaceName","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[{"DisplayAttributes":["Name","Identity"],"ObjectType":"workflow.MoReferenceProperty","Selector":"/api/v1/cloud/TfcWorkspaces","SelectorProperty":{"Method":"GET","ObjectType":"workflow.SelectorProperty"},"ValueAttribute":"Name"}],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true}],"InputParameterSet":[],"Label":"Confirm Terraform Run","Name":"ConfirmTerraformRun","ObjectType":"workflow.WorkflowDefinition","OutputDefinition":[{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Workspace ID","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Workspace ID","Name":"WorkspaceId","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Apply Method configured in the Workspace","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Workspace Auto Apply","Name":"WorkspaceAutoApply","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"boolean"}},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Current state version of the Workspace","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Current State Version","Name":"CurrentStateVersion","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true},{"ArrayItemType":{"ObjectType":"workflow.CustomArrayItem","Properties":{"CustomDataTypeName":"TerraformKeyValueType","ObjectType":"workflow.CustomDataProperty"}},"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Name-Value pairs of the State Outputs","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Outputs","Max":32,"Min":1,"Name":"Outputs","ObjectType":"workflow.ArrayDataType"},{"Default":{"ObjectType":"workflow.DefaultValue"},"DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Run ID","Name":"RunId","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Run Final State","Name":"RunFinalState","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Organization Name","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Organization Name","Name":"OrganizationName","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Workspace Name","Name":"WorkspaceName","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Apply Method configured in the Workspace","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Apply Method","Name":"ApplyMethod","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"}}],"OutputParameters":{"ApplyMethod":"{{.global.GetWorkspaceDetails.output.ApplyMethod}}","CurrentStateVersion":"{{.global.GetCurrentStateVersion.output.CurrentStateVersion}}","OrganizationName":"{{.global.GetWorkspaceDetails.output.OrganizationName}}","Outputs":"${QueryStateVersionOutput.output.NameValuePair}","RunFinalState":"{{if index .global.ValidateRunForManualApply.output `RunState`}}{{.global.ValidateRunForManualApply.output.RunState}}{{else}}{{.global.ValidateRunForAutoApply.output.RunState}}{{end}}","RunId":"{{if index .global.GetLatestRunIdForAutoapply.output `RunId`}}{{.global.GetLatestRunIdForAutoapply.output.RunId}}{{else}}{{.global.GetRunId.output.RunId}}{{end}}","WorkspaceId":"{{.global.GetWorkspaceDetails.output.WorkspaceId}}","WorkspaceName":"{{.global.GetWorkspaceDetails.output.WorkspaceName}}"},"Properties":{"ExternalMeta":true,"ObjectType":"workflow.WorkflowProperties","SupportStatus":"Supported"},"SharedScope":"shared","Tags":[{"Key":"category","Value":"Terraform Cloud"}],"Tasks":[{"Name":"StartTask","NextTask":"GetWorkspaceDetails","ObjectType":"workflow.StartTask"},{"CatalogMoid":"shared","Description":"Fetches the Workspace ID and AutoApply config for the given Name","InputParameters":{"TerraformCloudTarget":"${workflow.input.TerraformCloudTarget}","TerraformOrganizationName":"${workflow.input.TerraformOrganizationName}","TerraformWorkspaceName":"${workflow.input.TerraformWorkspaceName}"},"Label":"Get Workspace Details","Name":"GetWorkspaceDetails","ObjectType":"workflow.WorkerTask","OnSuccess":"AutoApplyDecisionTask","TaskDefinitionName":"GetTerraformWorkspaceDetails","Version":1},{"Condition":" if ( ${GetWorkspaceDetails.output.WorkspaceAutoApply} == false ) 'ManualApply'; else if ( ${GetWorkspaceDetails.output.WorkspaceAutoApply} == true )  'AutoApply'; ","DecisionCases":[{"Description":"Workspace configured with Auto Apply Method","NextTask":"GetLatestRunIdForAutoapply","ObjectType":"workflow.DecisionCase","Value":"AutoApply"},{"Description":"Workspace configured with Manual Apply Method","NextTask":"GetRunId","ObjectType":"workflow.DecisionCase","Value":"ManualApply"}],"DefaultTask":"FailureEndTask","Description":"Fetches the configured Apply Method","Label":"Auto Apply Decision Task","Name":"AutoApplyDecisionTask","ObjectType":"workflow.DecisionTask"},{"CatalogMoid":"shared","Description":"Manual Apply Method: Fetches the Run ID of runs in \"Needs Confirmation\" state","InputParameters":{"TerraformCloudTarget":"${workflow.input.TerraformCloudTarget}","WorkspaceId":"{{.global.GetWorkspaceDetails.output.WorkspaceId}}"},"Label":"Get Run ID","Name":"GetRunId","ObjectType":"workflow.WorkerTask","OnSuccess":"ApplyRun","TaskDefinitionName":"GetTerraformConfirmedRunId","Version":1},{"CatalogMoid":"shared","Description":"Auto Apply Method: Fetches the latest Run ID","InputParameters":{"TerraformCloudTarget":"${workflow.input.TerraformCloudTarget}","WorkspaceId":"{{.global.GetWorkspaceDetails.output.WorkspaceId}}"},"Label":"Get Latest Run ID For Autoapply","Name":"GetLatestRunIdForAutoapply","ObjectType":"workflow.WorkerTask","OnSuccess":"ValidateRunForAutoApply","TaskDefinitionName":"GetTerraformLatestRunId","Version":1},{"CatalogMoid":"shared","Description":"Manual Apply Method: Applies the run waiting for confirmation","InputParameters":{"RunId":"{{.global.GetRunId.output.RunId}}","TerraformCloudTarget":"${workflow.input.TerraformCloudTarget}"},"Label":"Apply Run","Name":"ApplyRun","ObjectType":"workflow.WorkerTask","OnSuccess":"ValidateRunForManualApply","TaskDefinitionName":"ConfirmTerraformRun","Version":1},{"CatalogMoid":"shared","Description":"Manual Apply Method: Checks the Run execution State","InputParameters":{"RunId":"{{.global.GetRunId.output.RunId}}","TerraformCloudTarget":"${workflow.input.TerraformCloudTarget}"},"Label":"Validate Run For Manual Apply","Name":"ValidateRunForManualApply","ObjectType":"workflow.WorkerTask","OnSuccess":"GetCurrentStateVersion","TaskDefinitionName":"GetTerraformRunState","Version":1},{"CatalogMoid":"shared","Description":"Auto Apply Method: Checks the Run execution state","InputParameters":{"RunId":"{{.global.GetLatestRunIdForAutoapply.output.RunId}}","TerraformCloudTarget":"${workflow.input.TerraformCloudTarget}"},"Label":"Validate Run For Auto Apply","Name":"ValidateRunForAutoApply","ObjectType":"workflow.WorkerTask","OnSuccess":"GetCurrentStateVersion","TaskDefinitionName":"GetTerraformRunState","Version":1},{"CatalogMoid":"shared","Description":"Fetches the Current State Version for the Workspace","InputParameters":{"TerraformCloudTarget":"${workflow.input.TerraformCloudTarget}","WorkspaceId":"{{.global.GetWorkspaceDetails.output.WorkspaceId}}"},"Label":"Get Current State Version","Name":"GetCurrentStateVersion","ObjectType":"workflow.WorkerTask","OnSuccess":"QueryStateVersionOutputs","TaskDefinitionName":"GetTerraformCurrentStateVersion","Version":1},{"Count":"{{len .global.GetCurrentStateVersion.output.StateVersionOutputs}}","Description":"Queries Name and Value of State Version Outputs","Label":"Query State Version Outputs","LoopStartTask":"QueryStateVersionOutput","Name":"QueryStateVersionOutputs","NumberOfBatches":1,"ObjectType":"workflow.LoopTask","OnSuccess":"SuccessEndTask","Parallel":true},{"CatalogMoid":"shared","Description":"Queries Name and Value of State Version Output","InputParameters":{"StateVersionOutputId":"{{ index .global.GetCurrentStateVersion.output.StateVersionOutputs .iteration }}","TerraformCloudTarget":"${workflow.input.TerraformCloudTarget}"},"Label":"Query State Version Output","Name":"QueryStateVersionOutput","ObjectType":"workflow.SubWorkflowTask","Version":1,"WorkflowDefinitionName":"GetTerraformStateOutputNameValue"},{"Name":"SuccessEndTask","ObjectType":"workflow.SuccessEndTask"},{"Name":"FailureEndTask","ObjectType":"workflow.FailureEndTask"}],"UiInputFilters":[{"Filters":["Organization.Moid eq '${TerraformOrganizationName.Moid}'"],"Name":"TerraformWorkspaceName","ObjectType":"workflow.UiInputFilter","UserHelpMessage":"Select 'Terraform Organization Name' before selecting 'Terraform Workspace Name'"}],"Version":1},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/WorkflowDefinitions","Verb":"POST"},{"Body":{"ClassId":"workflow.CustomDataTypeDefinition","CompositeType":true,"Description":"Updating variables in the Terraform Workspace","Label":"Terraform Update Variables Options","Name":"TerraformUpdateVariablesOptions","ObjectType":"workflow.CustomDataTypeDefinition","ParameterSet":[{"Condition":"eq","ControlParameter":"VariableType","EnableParameters":["UpdateTerraformVariables"],"Name":"NonSensitiveVariables","ObjectType":"workflow.ParameterSet","Value":"NonSensitiveVariables"},{"Condition":"eq","ControlParameter":"VariableType","EnableParameters":["UpdateSensitiveTerraformVariables"],"Name":"SensitiveVariables","ObjectType":"workflow.ParameterSet","Value":"SensitiveVariables"},{"Condition":"eq","ControlParameter":"VariableType","EnableParameters":["UpdateTerraformVariables","UpdateSensitiveTerraformVariables"],"Name":"Both","ObjectType":"workflow.ParameterSet","Value":"Both"}],"Properties":{"ObjectType":"workflow.CustomDataTypeProperties"},"SharedScope":"shared","TypeDefinition":[{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Type of variables to be updated","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Variable Type","Name":"VariableType","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[{"Label":"Non Sensitive Variables","ObjectType":"workflow.EnumEntry","Value":"NonSensitiveVariables"},{"Label":"Sensitive Variables","ObjectType":"workflow.EnumEntry","Value":"SensitiveVariables"},{"Label":"Both","ObjectType":"workflow.EnumEntry","Value":"Both"}],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"enum"},"Required":true},{"ArrayItemType":{"ObjectType":"workflow.CustomArrayItem","Properties":{"CustomDataTypeName":"TerraformKeyValueType","ObjectType":"workflow.CustomDataProperty"}},"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Variables to be updated in the Terraform Workspace","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Update Terraform Variables","Max":100,"Name":"UpdateTerraformVariables","ObjectType":"workflow.ArrayDataType"},{"ArrayItemType":{"ObjectType":"workflow.CustomArrayItem","Properties":{"CustomDataTypeName":"TerraformSensitiveKeyValueType","ObjectType":"workflow.CustomDataProperty"}},"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Sensitive Variables to be updated in the Terraform Workspace","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Update Sensitive Terraform Variables","Max":100,"Name":"UpdateSensitiveTerraformVariables","ObjectType":"workflow.ArrayDataType"}]},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/CustomDataTypeDefinitions","Verb":"POST"},{"Body":{"ClassId":"workflow.TaskDefinition","DefaultVersion":true,"Description":"Get Variable Id from Terraform Workspace","Label":"Get Variable Id","Name":"GetTerraformVariableId","ObjectType":"workflow.TaskDefinition","Properties":{"InputDefinition":[{"CustomDataTypeProperties":{"CatalogMoid":"shared","ObjectType":"workflow.CustomDataProperty"},"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Terraform Cloud Target","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Terraform Cloud Target","Name":"TerraformCloudTarget","ObjectType":"workflow.TargetDataType","Properties":[{"DisplayAttributes":["Name","TargetType"],"ObjectType":"workflow.TargetProperty","Selector":"/api/v1/asset/Targets?$filter=(TargetType eq TerraformCloud and Status eq Connected)","SelectorProperty":{"Method":"GET","ObjectType":"workflow.SelectorProperty"}}],"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Workspace ID","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Identity of the Terraform Workspace","Name":"WorkspaceId","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Terraform Variable whose Identity needs to be fetched","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Terraform Variable","Name":"TerraformVariable","ObjectType":"workflow.CustomDataType","Properties":{"CatalogMoid":"shared","CustomDataTypeName":"TerraformKeyValueType","ObjectType":"workflow.CustomDataProperty"}}],"ObjectType":"workflow.Properties","OutputDefinition":[{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Identity of the sensitive Terraform variable","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Variable ID","Name":"VariableId","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"}}],"RetryDelay":60,"RetryPolicy":"Fixed","SupportStatus":"Supported","Timeout":600,"TimeoutPolicy":"Timeout"},"RollbackTasks":[],"SharedScope":"shared","Tags":[{"Key":"category","Value":"Terraform Cloud"}],"Version":1},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/TaskDefinitions","Verb":"POST"},{"Body":{"ClassId":"workflow.WorkflowDefinition","DefaultVersion":true,"Description":"Updates a non-sensitive variable in the Terraform Workspace","InputDefinition":[{"CustomDataTypeProperties":{"CatalogMoid":"shared","ObjectType":"workflow.CustomDataProperty"},"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Terraform Cloud Target","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Terraform Cloud Target","Name":"TerraformCloudTarget","ObjectType":"workflow.TargetDataType","Properties":[{"DisplayAttributes":["Name","TargetType"],"ObjectType":"workflow.TargetProperty","Selector":"/api/v1/asset/Targets?$filter=(TargetType eq TerraformCloud and Status eq Connected)","SelectorProperty":{"Method":"GET","ObjectType":"workflow.SelectorProperty"}}],"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Identity of the Terraform Workspace","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Workspace ID","Name":"WorkspaceId","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Terraform variable to be updated","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Terraform Variable","Name":"TerraformVariable","ObjectType":"workflow.CustomDataType","Properties":{"CatalogMoid":"shared","CustomDataTypeName":"TerraformKeyValueType","ObjectType":"workflow.CustomDataProperty"}}],"InputParameterSet":[],"Label":"Update Terraform Variable","Name":"UpdateTerraformVariable","ObjectType":"workflow.WorkflowDefinition","OutputDefinition":[{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Identity of the variable to be updated","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Variable Id","Name":"VariableId","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true}],"OutputParameters":{"VariableId":"{{.global.GetTerraformVariableId.output.VariableId}}"},"Properties":{"ObjectType":"workflow.WorkflowProperties","SupportStatus":"Supported"},"SharedScope":"shared","Tasks":[{"Name":"StartTask","NextTask":"GetTerraformVariableId","ObjectType":"workflow.StartTask"},{"Name":"SuccessEndTask","ObjectType":"workflow.SuccessEndTask"},{"Name":"FailureEndTask","ObjectType":"workflow.FailureEndTask"},{"CatalogMoid":"shared","Description":"Fetches the ID of a given variable","InputParameters":{"TerraformCloudTarget":"${workflow.input.TerraformCloudTarget}","TerraformVariable":"${workflow.input.TerraformVariable}","WorkspaceId":"${workflow.input.WorkspaceId}"},"Label":"Get Variable Id","Name":"GetTerraformVariableId","ObjectType":"workflow.WorkerTask","OnSuccess":"UpdateVar","TaskDefinitionName":"GetTerraformVariableId","Version":1},{"CatalogMoid":"shared","Description":"Update the Variable with the value provided in the workflow\n","InputParameters":{"Body":{"ContentType":"json","Text":" {\n \"data\": {\n \"id\": \"{{.global.GetTerraformVariableId.output.VariableId}}\",\n \"attributes\": {\n \"key\": \"{{- if index .global.workflow.input.TerraformVariable `Key` -}} {{.global.workflow.input.TerraformVariable.Key | TrimSpace}} {{- end -}}\",\n \"value\": \"{{- if index .global.workflow.input.TerraformVariable `Value` -}} {{.global.workflow.input.TerraformVariable.Value | TrimSpace}} {{- end -}}\",\n \"sensitive\": false\n }\n }\n }"},"ContentType":"json","Headers":{"Content-Type":["application/vnd.api+json"]},"Method":"PATCH","Outcomes":[{"Condition":"{{eq .local.response.HttpStatusCode 422}}","Message":"The variable ${workflow.input.TerraformVariable.Key} was not updated. \"{{.local.response.detail}}\". Do try again.","Name":"SensitiveToNormalNotAllowed","Type":"Error"},{"Condition":"{{eq .local.response.HttpStatusCode 200}}","Message":"The variable \"${workflow.input.TerraformVariable.Key}\" is updated.","Name":"SuccessCase","Type":"Success"},{"Condition":"{{ne .local.response.HttpStatusCode 200}}","Message":"The variable ${workflow.input.TerraformVariable.Key} was not updated. Do try again. {{.local.response.HttpStatusMsg}}.\"","Name":"FailureCase","Type":"Error"}],"Protocol":"https","ResponseParser":{"Parameters":[{"Name":"detail","Path":"$.errors[0].detail","Type":"simple"}]},"Target":"${workflow.input.TerraformCloudTarget}","Url":"/api/v2/workspaces/{{.global.workflow.input.WorkspaceId}}/vars/{{.global.GetTerraformVariableId.output.VariableId}}"},"Label":"Update Variable","Name":"UpdateVar","ObjectType":"workflow.WorkerTask","OnSuccess":"SuccessEndTask","TaskDefinitionName":"InvokeGenericWebApi","Version":1}],"UiInputFilters":[],"Version":1},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/WorkflowDefinitions","Verb":"POST"},{"Body":{"ClassId":"workflow.CustomDataTypeDefinition","CompositeType":true,"Description":"Terraform workspace update sensitive variable type","Label":"Terraform Sensitive Key Value Type","Name":"TerraformSensitiveKeyValueType","ObjectType":"workflow.CustomDataTypeDefinition","ParameterSet":[],"Properties":{"ObjectType":"workflow.CustomDataTypeProperties"},"SharedScope":"shared","TypeDefinition":[{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Terraform variable key can only contain letters, numbers, underscores and hyphens","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Key","Name":"Key","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints","Regex":"^[a-zA-Z0-9_-]*$"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Value of the terraform variable","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Value","Name":"Value","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Secure":true,"Type":"string"}}]},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/CustomDataTypeDefinitions","Verb":"POST"},{"Body":{"ClassId":"workflow.TaskDefinition","DefaultVersion":true,"Description":"Get Sensitive Variable Id from Terraform Workspace","Label":"Get Terraform Sensitive Variable Id","Name":"GetTerraformSensitiveVariableId","ObjectType":"workflow.TaskDefinition","Properties":{"InputDefinition":[{"CustomDataTypeProperties":{"CatalogMoid":"shared","ObjectType":"workflow.CustomDataProperty"},"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Terraform Cloud Target","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Terraform Cloud Target","Name":"TerraformCloudTarget","ObjectType":"workflow.TargetDataType","Properties":[{"DisplayAttributes":["Name","TargetType"],"ObjectType":"workflow.TargetProperty","Selector":"/api/v1/asset/Targets?$filter=(TargetType eq TerraformCloud and Status eq Connected)","SelectorProperty":{"Method":"GET","ObjectType":"workflow.SelectorProperty"}}],"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Identity of the Terraform Workspace","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Workspace ID","Name":"WorkspaceId","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Sensitive Terraform variable whose Identity needs to be fetched","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Terraform Variable","Name":"TerraformVariable","ObjectType":"workflow.CustomDataType","Properties":{"CatalogMoid":"shared","CustomDataTypeName":"TerraformSensitiveKeyValueType","ObjectType":"workflow.CustomDataProperty"}}],"ObjectType":"workflow.Properties","OutputDefinition":[{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Identity of the sensitive Terraform variable","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Variable ID","Name":"VariableId","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"}}],"RetryDelay":60,"RetryPolicy":"Fixed","SupportStatus":"Supported","Timeout":600,"TimeoutPolicy":"Timeout"},"RollbackTasks":[],"SecurePropAccess":true,"SharedScope":"shared","Tags":[{"Key":"category","Value":"Terraform Cloud"}],"Version":1},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/TaskDefinitions","Verb":"POST"},{"Body":{"ClassId":"workflow.WorkflowDefinition","DefaultVersion":true,"Description":"Updates a sensitive variable in the Terraform Workspace","InputDefinition":[{"CustomDataTypeProperties":{"CatalogMoid":"shared","ObjectType":"workflow.CustomDataProperty"},"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Terraform Cloud Target","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Terraform Cloud Target","Name":"TerraformCloudTarget","ObjectType":"workflow.TargetDataType","Properties":[{"DisplayAttributes":["Name","TargetType"],"ObjectType":"workflow.TargetProperty","Selector":"/api/v1/asset/Targets?$filter=(TargetType eq TerraformCloud and Status eq Connected)","SelectorProperty":{"Method":"GET","ObjectType":"workflow.SelectorProperty"}}],"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Identity of the Terraform Workspace","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Workspace ID","Name":"WorkspaceId","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Sensitive terraform variable to be updated","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Terraform Variable","Name":"TerraformVariable","ObjectType":"workflow.CustomDataType","Properties":{"CatalogMoid":"shared","CustomDataTypeName":"TerraformSensitiveKeyValueType","ObjectType":"workflow.CustomDataProperty"}}],"InputParameterSet":[],"Label":"Update Terraform Sensitive Variable","Name":"UpdateTerraformSensitiveVariable","ObjectType":"workflow.WorkflowDefinition","OutputDefinition":[{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Identity of the sensitive variable to be updated","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Variable Id","Name":"VariableId","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true}],"OutputParameters":{"VariableId":"{{.global.GetTerraformSensitiveVariableId.output.VariableId}}"},"Properties":{"ObjectType":"workflow.WorkflowProperties","SupportStatus":"Supported"},"SharedScope":"shared","Tasks":[{"Name":"StartTask","NextTask":"GetTerraformSensitiveVariableId","ObjectType":"workflow.StartTask"},{"Name":"SuccessEndTask","ObjectType":"workflow.SuccessEndTask"},{"Name":"FailureEndTask","ObjectType":"workflow.FailureEndTask"},{"CatalogMoid":"shared","Description":"Fetches the ID of the given sensitive variable","InputParameters":{"TerraformCloudTarget":"${workflow.input.TerraformCloudTarget}","TerraformVariable":"${workflow.input.TerraformVariable}","WorkspaceId":"${workflow.input.WorkspaceId}"},"Label":"Get Terraform Sensitive Variable Id","Name":"GetTerraformSensitiveVariableId","ObjectType":"workflow.WorkerTask","OnSuccess":"UpdateSensitiveVar","TaskDefinitionName":"GetTerraformSensitiveVariableId","Version":1},{"CatalogMoid":"shared","Description":"Update the Sensitive Variable with the value provided in the workflow\n","InputParameters":{"Body":{"ContentType":"json","Text":" {\n \"data\": {\n \"id\": \"{{.global.GetTerraformSensitiveVariableId.output.VariableId}}\",\n \"attributes\": {\n \"key\": \"{{- if index .global.workflow.input.TerraformVariable `Key` -}} {{.global.workflow.input.TerraformVariable.Key | TrimSpace}} {{- end -}}\",\n \"value\": \"{{- if index .global.workflow.input.TerraformVariable `Value` -}} {{.global.workflow.input.TerraformVariable.Value | TrimSpace}} {{- end -}}\",\n \"sensitive\": true\n }\n }\n }"},"ContentType":"json","Headers":{"Content-Type":["application/vnd.api+json"]},"Method":"PATCH","Outcomes":[{"Condition":"{{eq .local.response.HttpStatusCode 200}}","Message":"The variable \"${workflow.input.TerraformVariable.Key}\" is updated.","Name":"SuccessCase","Type":"Success"},{"Condition":"{{ne .local.response.HttpStatusCode 200}}","Message":"The variable \"${workflow.input.TerraformVariable.Key}\" was not updated. Do try again. {{.local.response.HttpStatusMsg}}.\"","Name":"FailureCase","Type":"Error"}],"Protocol":"https","Target":"${workflow.input.TerraformCloudTarget}","Url":"/api/v2/workspaces/{{.global.workflow.input.WorkspaceId}}/vars/{{.global.GetTerraformSensitiveVariableId.output.VariableId}}"},"Label":"Update Sensitive Terraform Variable","Name":"UpdateSensitiveVar","ObjectType":"workflow.WorkerTask","OnSuccess":"SuccessEndTask","TaskDefinitionName":"InvokeGenericWebApi","Version":1}],"UiInputFilters":[],"Version":1},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/WorkflowDefinitions","Verb":"POST"},{"Body":{"ClassId":"workflow.WorkflowDefinition","DefaultVersion":true,"Description":"Updates variables in the Terraform Workspace","InputDefinition":[{"CustomDataTypeProperties":{"CatalogMoid":"shared","ObjectType":"workflow.CustomDataProperty"},"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Terraform Cloud Target","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Terraform Cloud Target","Name":"TerraformCloudTarget","ObjectType":"workflow.TargetDataType","Properties":[{"DisplayAttributes":["Name","TargetType"],"ObjectType":"workflow.TargetProperty","Selector":"/api/v1/asset/Targets?$filter=(TargetType eq TerraformCloud and Status eq Connected)","SelectorProperty":{"Method":"GET","ObjectType":"workflow.SelectorProperty"}}],"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Name of the Terraform Organization","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Terraform Organization Name","Name":"TerraformOrganizationName","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[{"DisplayAttributes":["Name","Identity"],"ObjectType":"workflow.MoReferenceProperty","Selector":"/api/v1/cloud/TfcOrganizations","SelectorProperty":{"Method":"GET","ObjectType":"workflow.SelectorProperty"},"ValueAttribute":"Name"}],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Name of the Terraform Workspace","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Terraform Workspace Name","Name":"TerraformWorkspaceName","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[{"DisplayAttributes":["Name","Identity"],"ObjectType":"workflow.MoReferenceProperty","Selector":"/api/v1/cloud/TfcWorkspaces","SelectorProperty":{"Method":"GET","ObjectType":"workflow.SelectorProperty"},"ValueAttribute":"Name"}],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Update Variables","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Update Variables Options","Name":"UpdateVariablesOptions","ObjectType":"workflow.CustomDataType","Properties":{"CatalogMoid":"shared","CustomDataTypeName":"TerraformUpdateVariablesOptions","ObjectType":"workflow.CustomDataProperty"},"Required":true}],"InputParameterSet":[],"Label":"Update Terraform Variables","Name":"UpdateTerraformVariables","ObjectType":"workflow.WorkflowDefinition","OutputDefinition":[{"Default":{"ObjectType":"workflow.DefaultValue"},"DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"WorkspaceId","Name":"WorkspaceId","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true}],"OutputParameters":{"WorkspaceId":"{{ .global.GetWorkspaceDetails.output.WorkspaceId}}"},"Properties":{"ExternalMeta":true,"ObjectType":"workflow.WorkflowProperties","Retryable":true,"SupportStatus":"Supported"},"SharedScope":"shared","Tags":[{"Key":"category","Value":"Terraform Cloud"}],"Tasks":[{"Name":"StartTask","NextTask":"GetWorkspaceDetails","ObjectType":"workflow.StartTask"},{"CatalogMoid":"shared","Description":"Fetches the Workspace ID and AutoApply config for the given Name","InputParameters":{"TerraformCloudTarget":"${workflow.input.TerraformCloudTarget}","TerraformOrganizationName":"${workflow.input.TerraformOrganizationName}","TerraformWorkspaceName":"${workflow.input.TerraformWorkspaceName}"},"Label":"Get Workspace Details","Name":"GetWorkspaceDetails","ObjectType":"workflow.WorkerTask","OnSuccess":"UpdateTerraformVariables","TaskDefinitionName":"GetTerraformWorkspaceDetails","Version":1},{"Count":"{{ len .global.workflow.input.UpdateVariablesOptions.UpdateTerraformVariables }}","Description":"Update required Terraform Variables","Label":"Update Terraform Variables","LoopStartTask":"UpdateVariable","Name":"UpdateTerraformVariables","NumberOfBatches":1,"ObjectType":"workflow.LoopTask","OnSuccess":"UpdateSensitiveTerraformVariables","Parallel":true},{"CatalogMoid":"shared","Description":"Update Terraform Variable","InputParameters":{"TerraformCloudTarget":"${workflow.input.TerraformCloudTarget}","TerraformVariable":"{{ index .global.workflow.input.UpdateVariablesOptions.UpdateTerraformVariables .iteration | ToJson}}","WorkspaceId":"{{.global.GetWorkspaceDetails.output.WorkspaceId}}"},"Label":"Update Variable","Name":"UpdateVariable","ObjectType":"workflow.SubWorkflowTask","Version":1,"WorkflowDefinitionName":"UpdateTerraformVariable"},{"Count":"{{ len .global.workflow.input.UpdateVariablesOptions.UpdateSensitiveTerraformVariables }}","Description":"Update required Sensitive Terraform Variables","Label":"Update Sensitive Terraform Variables","LoopStartTask":"UpdateSensitiveVariable","Name":"UpdateSensitiveTerraformVariables","NumberOfBatches":1,"ObjectType":"workflow.LoopTask","OnSuccess":"SuccessEndTask","Parallel":true},{"CatalogMoid":"shared","Description":"Update Terraform Sensitive Variable","InputParameters":{"TerraformCloudTarget":"${workflow.input.TerraformCloudTarget}","TerraformVariable":"{{ index .global.workflow.input.UpdateVariablesOptions.UpdateSensitiveTerraformVariables .iteration | ToJson}}","WorkspaceId":"{{.global.GetWorkspaceDetails.output.WorkspaceId}}"},"Label":"Update Sensitive Variable","Name":"UpdateSensitiveVariable","ObjectType":"workflow.SubWorkflowTask","Version":1,"WorkflowDefinitionName":"UpdateTerraformSensitiveVariable"},{"Name":"SuccessEndTask","ObjectType":"workflow.SuccessEndTask"},{"Name":"FailureEndTask","ObjectType":"workflow.FailureEndTask"}],"UiInputFilters":[{"Filters":["Organization.Moid eq '${TerraformOrganizationName.Moid}'"],"Name":"TerraformWorkspaceName","ObjectType":"workflow.UiInputFilter","UserHelpMessage":"Select 'Terraform Organization Name' before selecting 'Terraform Workspace Name'"}],"Version":1},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/WorkflowDefinitions","Verb":"POST"},{"Body":{"ClassId":"workflow.WorkflowDefinition","DefaultVersion":true,"InputDefinition":[{"CustomDataTypeProperties":{"CatalogMoid":"user","ObjectType":"workflow.CustomDataProperty"},"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Terraform Cloud Target","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Terraform Cloud Target","Name":"TerraformCloudTarget","ObjectType":"workflow.TargetDataType","Properties":[{"DisplayAttributes":["Name","TargetType"],"ObjectType":"workflow.TargetProperty","Selector":"/api/v1/asset/Targets?$filter=(TargetType eq TerraformCloud and Status eq Connected)","SelectorProperty":{"Method":"GET","ObjectType":"workflow.SelectorProperty"}}],"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"Description":"Terraform Organization Name must only contain letters, numbers, dashes and underscores","DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"Terraform Organization Name","Name":"TerraformOrganizationName","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints","Regex":"^[a-zA-Z0-9_-]*$"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Type":"string"},"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"TfcbToken","Name":"TfcbToken","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Secure":true,"Type":"string"},"Required":true},{"Default":{"ObjectType":"workflow.DefaultValue"},"DisplayMeta":{"InventorySelector":true,"ObjectType":"workflow.DisplayMeta","WidgetType":"None"},"Label":"TfcbAgentPoolId","Name":"TfcbAgentPoolId","ObjectType":"workflow.PrimitiveDataType","Properties":{"Constraints":{"EnumList":[],"ObjectType":"workflow.Constraints"},"InventorySelector":[],"ObjectType":"workflow.PrimitiveDataProperty","Secure":true,"Type":"string"},"Required":true}],"InputParameterSet":[],"Label":"OnlyLoad","Name":"OnlyLoad","ObjectType":"workflow.WorkflowDefinition","OutputDefinition":[],"Properties":{"ExternalMeta":true,"ObjectType":"workflow.WorkflowProperties","SupportStatus":"Supported"},"SharedScope":"user","Tasks":[{"Name":"StartTask","NextTask":"UpdateTerraformVariables1","ObjectType":"workflow.StartTask"},{"Name":"SuccessEndTask","ObjectType":"workflow.SuccessEndTask"},{"Name":"FailureEndTask","ObjectType":"workflow.FailureEndTask"},{"CatalogMoid":"shared","Description":"InvokeSleepTask","InputParameters":{"SleepTimeInSec":240},"Label":"Sleep Task Load","Name":"InvokeSleepTask7","ObjectType":"workflow.WorkerTask","OnSuccess":"ConfirmTerraformRun1","TaskDefinitionName":"InvokeSleepTask","Version":1},{"CatalogMoid":"shared","Description":"Starts a plan in the terraform workspace","InputParameters":{"PlanOperation":"false","ReasonForStartingPlan":"demoico2","TerraformCloudTarget":"${workflow.input.TerraformCloudTarget}","TerraformOrganizationName":"${workflow.input.TerraformOrganizationName}","TerraformWorkspaceName":"AppdLoad"},"Label":"Start New Terraform Plan","Name":"StartNewTerraformPlan1","ObjectType":"workflow.SubWorkflowTask","OnSuccess":"InvokeSleepTask7","Version":1,"WorkflowDefinitionName":"StartNewTerraformPlan"},{"CatalogMoid":"shared","Description":"Confirms and applies a Run waiting for confirmation for a Workspace configured with manual apply. Checks the execution state of the Run for a Workspace configured with auto apply.","InputParameters":{"TerraformCloudTarget":"${workflow.input.TerraformCloudTarget}","TerraformOrganizationName":"${workflow.input.TerraformOrganizationName}","TerraformWorkspaceName":"AppdLoad"},"Label":"Confirm Terraform Run","Name":"ConfirmTerraformRun1","ObjectType":"workflow.SubWorkflowTask","OnSuccess":"SuccessEndTask","Version":1,"WorkflowDefinitionName":"ConfirmTerraformRun"},{"CatalogMoid":"shared","Description":"Updates variables in the Terraform Workspace","InputParameters":{"TerraformCloudTarget":"${workflow.input.TerraformCloudTarget}","TerraformOrganizationName":"${workflow.input.TerraformOrganizationName}","TerraformWorkspaceName":"AppdLoad","UpdateVariablesOptions":{"UpdateTerraformVariables":[{"Key":"trigcount","Value":"21"}],"VariableType":"NonSensitiveVariables"}},"Label":"Update Terraform Variables","Name":"UpdateTerraformVariables1","ObjectType":"workflow.SubWorkflowTask","OnSuccess":"StartNewTerraformPlan1","Version":1,"WorkflowDefinitionName":"UpdateTerraformVariables"}],"UiInputFilters":[],"UiRenderingData":{"Positions":[{"Name":"StartTask","X":263.5,"Y":40.000016650992706},{"Name":"SuccessEndTask","X":263.5,"Y":513.0000238514219},{"Name":"FailureEndTask","X":406.5,"Y":513.0000238514219},{"Name":"InvokeSleepTask7","X":178.5,"Y":315.0000301517976},{"Name":"StartNewTerraformPlan1","X":178.5,"Y":215.91486340149316},{"Name":"ConfirmTerraformRun1","X":178.4964004956443,"Y":413.82975763704644},{"Name":"UpdateTerraformVariables1","X":178.4147729593885,"Y":117.24839505735787}]},"Version":1},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/WorkflowDefinitions","Verb":"POST"},{"Body":{"Batch":[{"ContentType":"json","EndpointRequestType":"Internal","Headers":"{\"Content-Type\": [\"application/vnd.api+json\"]}","Method":"GET","Name":"GetTerraformWorkspaceDetails","ObjectType":"workflow.WebApi","Outcomes":[{"Condition":"{{eq .global.GetTerraformWorkspaceDetails.output.HttpStatusCode 404}}","Message":"The \"{{.global.task.input.TerraformOrganizationName}} / {{.global.task.input.TerraformWorkspaceName}}\" Terraform Organisation Workspace names are not in the system. Try again by providing the right names.","ObjectType":"workflow.Outcome","Type":"Error"},{"Condition":"{{ne .global.GetTerraformWorkspaceDetails.output.HttpStatusCode 200}}","Message":"We are unable to fetch the Workspace details due to an unexpected error. Do try again. \"{{.global.GetTerraformWorkspaceDetails.output.HttpStatusMsg}}.\"","ObjectType":"workflow.Outcome","Type":"Error"},{"Condition":"{{eq .global.GetTerraformWorkspaceDetails.output.HttpStatusCode 200}}","Message":"The Workspace ID in use is \"{{.global.GetTerraformWorkspaceDetails.output.WorkspaceId}}\".","ObjectType":"workflow.Outcome","Type":"Success"}],"Protocol":"https","ResponseSpec":{"ErrorParameters":[],"ObjectType":"content.Grammar","Parameters":[{"AcceptSingleValue":false,"ComplexType":"","ItemType":"simple","Name":"WorkspaceId","ObjectType":"content.Parameter","Path":"$.data.id","Secure":false,"Type":"simple"},{"AcceptSingleValue":false,"ComplexType":"","ItemType":"simple","Name":"WorkspaceAutoApply","ObjectType":"content.Parameter","Path":"$[\"data\"][\"attributes\"][\"auto-apply\"]","Secure":false,"Type":"simple"},{"AcceptSingleValue":false,"ComplexType":"","ItemType":"simple","Name":"AgentPoolId","ObjectType":"content.Parameter","Path":"$[\"data\"][\"relationships\"][\"agent-pool\"][\"data\"][\"id\"]","Secure":false,"Type":"simple"},{"AcceptSingleValue":false,"ComplexType":"","ItemType":"simple","Name":"ExecutionMode","ObjectType":"content.Parameter","Path":"$[\"data\"][\"attributes\"][\"execution-mode\"]","Secure":false,"Type":"simple"},{"AcceptSingleValue":false,"ComplexType":"","ItemType":"simple","Name":"UserInterface","ObjectType":"content.Parameter","Path":"$[\"data\"][\"attributes\"][\"structured-run-output-enabled\"]","Secure":false,"Type":"simple"}],"Types":[]},"TargetType":"Endpoint","Url":"/api/v2/organizations/{{.global.task.input.TerraformOrganizationName}}/workspaces/{{.global.task.input.TerraformWorkspaceName}}"},{"ContentType":"json","EndpointRequestType":"Internal","Method":"GET","Name":"GetAgentPoolName","ObjectType":"workflow.WebApi","Outcomes":[{"Condition":"{{ne .global.GetAgentPoolName.output.HttpStatusCode 200}}","Message":"We are unable to fetch the name of agent with ID \"{{.global.GetTerraformWorkspaceDetails.output.AgentPoolId}}\".","Name":"FetchingAgentPoolNameFailure","Type":"Error"},{"Condition":"{{eq .global.GetAgentPoolName.output.HttpStatusCode 200}}","Message":"The Workspace ID in use is \"{{.global.GetTerraformWorkspaceDetails.output.WorkspaceId}}\" and the agent pool in use is \"{{index .global.GetAgentPoolName.output.AgentPoolName 0}}\".","Name":"FetchingAgentPoolNameSuccess","Type":"Success"}],"Protocol":"https","ResponseSpec":{"ErrorParameters":[],"ObjectType":"content.Grammar","Parameters":[{"AcceptSingleValue":false,"ComplexType":"","ItemType":"simple","Name":"AgentPoolName","ObjectType":"content.Parameter","Path":"$[\"Results\"][?(@[\"Identity\"]==\"{{.global.GetTerraformWorkspaceDetails.output.AgentPoolId}}\")][\"Name\"]","Secure":false,"Type":"simple"}],"Types":[]},"SkipOnCondition":"{{ if index .global.GetTerraformWorkspaceDetails.output \"AgentPoolId\"}} false {{else}} true {{end}}","TargetType":"Local","Url":"/v1/cloud/TfcAgentpools"}],"ClassId":"workflow.BatchApiExecutor","Constraints":{"ObjectType":"workflow.TaskConstraints"},"Description":"API Task to fetch workspace Id","Name":"GetTerraformWorkspaceDetails","ObjectType":"workflow.BatchApiExecutor","Output":{"AgentPoolId":"{{.global.GetTerraformWorkspaceDetails.output.AgentPoolId}}","AgentPoolName":"{{index .global.GetAgentPoolName.output.AgentPoolName 0}}","ApplyMethod":"{{ if eq .global.GetTerraformWorkspaceDetails.output.WorkspaceAutoApply true }} Auto apply {{else}} Manual apply {{end}}","ExecutionMode":"{{.global.GetTerraformWorkspaceDetails.output.ExecutionMode}}","OrganizationName":"{{.global.task.input.TerraformOrganizationName}}","UserInterface":"{{ if eq .global.GetTerraformWorkspaceDetails.output.UserInterface true }} Structured Run Output {{else}} Console UI {{end}}","WorkspaceAutoApply":"{{.global.GetTerraformWorkspaceDetails.output.WorkspaceAutoApply}}","WorkspaceId":"{{.global.GetTerraformWorkspaceDetails.output.WorkspaceId}}","WorkspaceName":"{{.global.task.input.TerraformWorkspaceName}}"},"SharedScope":"shared","TaskDefinition":{"ObjectType":"workflow.TaskDefinition","Selector":"Name eq \"GetTerraformWorkspaceDetails\" and Version eq 1"}},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/BatchApiExecutors","Verb":"POST"},{"Body":{"Batch":[{"Body":"{\"data\":{\"attributes\":{\"comment\":null, {{if index .global.task.input `ReasonForStartingPlan`}} \"message\":\"{{.global.task.input.ReasonForStartingPlan}}\"{{else}} \"message\":\"Triggered via Cisco Intersight Orchestrator\"{{end}},{{if index .global.task.input `PlanOperation`}} \"is-destroy\":\"{{.global.task.input.PlanOperation}}\" {{else}} \"is-destroy\": false {{end}}},\"relationships\":{\"workspace\":{\"data\":{\"type\":\"workspaces\",\"id\":\"{{.global.task.input.WorkspaceId}}\"}}},\"type\":\"runs\"}}","ContentType":"json","EndpointRequestType":"Internal","Headers":"{\"Content-Type\": [\"application/vnd.api+json\"]}","Method":"POST","Name":"StartNewTerraformPlan","ObjectType":"workflow.WebApi","Outcomes":[{"Condition":"{{eq .global.StartNewTerraformPlan.output.HttpStatusCode 422}}","Message":"We are unable to start a plan for the Workspace \"{{ .global.task.input.WorkspaceId }}\". \"{{ .global.StartNewTerraformPlan.output.detail }}.\" Do try again by uploading a configuration version.","Name":"ConfigDoesNotExist","Type":"Error"},{"Condition":"{{eq .global.StartNewTerraformPlan.output.HttpStatusCode 404}}","Message":"Either the Workspace ID is wrong or has not been provided. Do try again by providing the right Workspace ID.","Name":"WorkspaceIdEmpty","Type":"Error"},{"Condition":"{{ne .global.StartNewTerraformPlan.output.HttpStatusCode  201}}","Message":"We are unable to start a plan for the Workspace \"{{ .global.task.input.WorkspaceId }}\" due to an unexpected error. Do try again. \"{{ .global.StartNewTerraformPlan.output.HttpStatusMsg }}.\"","Name":"AnyOtherFailure","Type":"Error"},{"Condition":"{{eq .global.StartNewTerraformPlan.output.HttpStatusCode 201}}","Message":"Started new plan for the Workspace \"{{ .global.task.input.WorkspaceId }}\".","Name":"ConfigUploaded","Type":"Success"}],"Protocol":"https","ResponseSpec":{"ErrorParameters":[],"ObjectType":"content.Grammar","Parameters":[{"AcceptSingleValue":false,"ComplexType":"","ItemType":"simple","Name":"RunId","ObjectType":"content.Parameter","Path":"$.data.id","Secure":false,"Type":"simple"},{"AcceptSingleValue":false,"ComplexType":"","ItemType":"simple","Name":"detail","ObjectType":"content.Parameter","Path":"$.errors[0].detail","Secure":false,"Type":"simple"}],"Types":[]},"TargetType":"Endpoint","Url":"/api/v2/runs"}],"ClassId":"workflow.BatchApiExecutor","Constraints":{"ObjectType":"workflow.TaskConstraints"},"Description":"API Task to start a new plan","Name":"StartNewTerraformPlan","ObjectType":"workflow.BatchApiExecutor","Output":{"RunId":"{{.global.StartNewTerraformPlan.output.RunId}}"},"SharedScope":"shared","TaskDefinition":{"ObjectType":"workflow.TaskDefinition","Selector":"Name eq \"StartNewTerraformPlan\" and Version eq 1"}},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/BatchApiExecutors","Verb":"POST"},{"Body":{"Batch":[{"ContentType":"json","EndpointRequestType":"Internal","Headers":"{\"Content-Type\": [\"application/vnd.api+json\"]}","Method":"GET","Name":"GetTerraformConfirmedRunId","ObjectType":"workflow.WebApi","Outcomes":[{"Condition":"{{ne .global.GetTerraformConfirmedRunId.output.HttpStatusCode 200}}","Message":"We are unable to fetch the Run ID due to an unexpected error. Do try again. \"{{.global.GetTerraformConfirmedRunId.output.HttpStatusMsg}}.\"","ObjectType":"workflow.Outcome","Type":"Error"},{"Condition":"{{if not .global.GetTerraformConfirmedRunId.output.RunId}}true{{else}}false{{end}}","Message":"We are unable to fetch the Run ID. Do try again after ensuring that the Run is in one of \"Planned\" / \"Cost Estimated\" / \"Policy Checked\" state.","ObjectType":"workflow.Outcome","Type":"Error"},{"Condition":"true","Message":"The Run ID \"{{index .global.GetTerraformConfirmedRunId.output.RunId 0}}\" is in use.","ObjectType":"workflow.Outcome","Type":"Success"}],"Protocol":"https","ResponseSpec":{"ErrorParameters":[],"ObjectType":"content.Grammar","Parameters":[{"AcceptSingleValue":false,"ComplexType":"","ItemType":"simple","Name":"RunId","ObjectType":"content.Parameter","Path":"$[\"data\"][?(@[\"attributes\"][\"actions\"][\"is-confirmable\"]==true)][\"id\"]","Secure":false,"Type":"simple"}],"Types":[]},"TargetType":"Endpoint","Url":"/api/v2/workspaces/{{.global.task.input.WorkspaceId}}/runs"}],"ClassId":"workflow.BatchApiExecutor","Constraints":{"ObjectType":"workflow.TaskConstraints"},"Description":"API Task to fetch workspace Id","Name":"GetTerraformConfirmedRunId","ObjectType":"workflow.BatchApiExecutor","Output":{"RunId":"{{index .global.GetTerraformConfirmedRunId.output.RunId 0}}"},"SharedScope":"shared","TaskDefinition":{"ObjectType":"workflow.TaskDefinition","Selector":"Name eq \"GetTerraformConfirmedRunId\" and Version eq 1"}},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/BatchApiExecutors","Verb":"POST"},{"Body":{"Batch":[{"ContentType":"json","EndpointRequestType":"Internal","Headers":"{\"Content-Type\": [\"application/vnd.api+json\"]}","Method":"GET","Name":"GetTerraformLatestRunId","ObjectType":"workflow.WebApi","Outcomes":[{"Condition":"{{ne .global.GetTerraformLatestRunId.output.HttpStatusCode 200}}","Message":"We are unable to fetch the latest Run ID due to an unexpected error. Do try again. \"{{.global.GetTerraformLatestRunId.output.HttpStatusMsg}}.\"","ObjectType":"workflow.Outcome","Type":"Error"},{"Condition":"{{if not .global.GetTerraformLatestRunId.output.RunId}}true{{else}}false{{end}}","Message":"We are unable to fetch a Run ID. Do retry by uploading a configuration version.","ObjectType":"workflow.Outcome","Type":"Error"},{"Condition":"true","Message":"The Run ID \"{{.global.GetTerraformLatestRunId.output.RunId}}\" is in use","ObjectType":"workflow.Outcome","Type":"Success"}],"Protocol":"https","ResponseSpec":{"ErrorParameters":[],"ObjectType":"content.Grammar","Parameters":[{"AcceptSingleValue":false,"ComplexType":"","ItemType":"simple","Name":"RunId","ObjectType":"content.Parameter","Path":"$.data[0].id","Secure":false,"Type":"simple"}],"Types":[]},"TargetType":"Endpoint","Url":"/api/v2/workspaces/{{.global.task.input.WorkspaceId}}/runs"}],"ClassId":"workflow.BatchApiExecutor","Constraints":{"ObjectType":"workflow.TaskConstraints"},"Description":"API Task to fetch workspace Id","Name":"GetTerraformLatestRunId","ObjectType":"workflow.BatchApiExecutor","Output":{"RunId":"{{ .global.GetTerraformLatestRunId.output.RunId }}"},"SharedScope":"shared","TaskDefinition":{"ObjectType":"workflow.TaskDefinition","Selector":"Name eq \"GetTerraformLatestRunId\" and Version eq 1"}},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/BatchApiExecutors","Verb":"POST"},{"Body":{"Batch":[{"ContentType":"json","EndpointRequestType":"Internal","Headers":"{\"Content-Type\": [\"application/vnd.api+json\"]}","Method":"POST","Name":"ConfirmTerraformRun","ObjectType":"workflow.WebApi","Outcomes":[{"Condition":"{{eq .global.ConfirmTerraformRun.output.HttpStatusCode  409}}","Message":"We could not confirm the Run ID \"{{.global.task.input.RunId | TrimSpace}}\" for this workspace. Do try again by providing a Run ID that is in one of \"Planned\" / \"Cost Estimated\" / \"Policy Checked\" state.","Name":"RunIdDoesNotHaveIsConfirmableTrue","Type":"Error"},{"Condition":"{{eq .global.ConfirmTerraformRun.output.HttpStatusCode  404}}","Message":"The Run ID \"{{.global.task.input.RunId | TrimSpace}}\" is invalid. Do try again by providing the correct Run ID.","Name":"RunIdDoesNotExist","Type":"Error"},{"Condition":"{{ne .global.ConfirmTerraformRun.output.HttpStatusCode  202}}","Message":"We are unable to confirm the run due to an unexpected error. Do try again. \"{{ .global.ConfirmTerraformRun.output.HttpStatusMsg }}.\"","Name":"AnyOtherFailure","Type":"Error"},{"Condition":"{{eq .global.ConfirmTerraformRun.output.HttpStatusCode 202}}","Message":"The Run ID \"{{.global.task.input.RunId | TrimSpace}}\" is confirmed and will be applied.","Name":"ConfirmRunSubmitted","Type":"Success"}],"Protocol":"https","ResponseSpec":{"ErrorParameters":[],"ObjectType":"content.Grammar","Parameters":[],"Types":[]},"TargetType":"Endpoint","Url":"/api/v2/runs/{{ if index .global.task.input `RunId` }}{{.global.task.input.RunId | TrimSpace}}{{end}}/actions/apply"}],"ClassId":"workflow.BatchApiExecutor","Constraints":{"ObjectType":"workflow.TaskConstraints"},"Description":"API Task to confirm the run and execute terrafom apply","Name":"ConfirmTerraformRun","ObjectType":"workflow.BatchApiExecutor","Output":{},"SharedScope":"shared","TaskDefinition":{"ObjectType":"workflow.TaskDefinition","Selector":"Name eq \"ConfirmTerraformRun\" and Version eq 1"}},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/BatchApiExecutors","Verb":"POST"},{"Body":{"Batch":[{"ContentType":"json","EndpointRequestType":"Internal","Headers":"{\"Content-Type\": [\"application/vnd.api+json\"]}","Method":"GET","Name":"GetTerraformRunFinalState","ObjectType":"workflow.WebApi","Outcomes":[{"Condition":"{{ eq .global.GetTerraformRunFinalState.output.HttpStatusCode 404 }}","Message":"This Run ID \"{{ .global.task.input.RunId }}\" does not exist. Do try again by providing the right Run ID.","ObjectType":"workflow.Outcome","Type":"TerminalError"},{"Condition":"{{ ( or (eq .global.GetTerraformRunFinalState.output.RunState \"applied\") (eq .global.GetTerraformRunFinalState.output.RunState \"planned_and_finished\") ) }}","Message":"The Run ID \"{{ .global.task.input.RunId }}\" is in \"{{.global.GetTerraformRunFinalState.output.RunState}}\" state.","ObjectType":"workflow.Outcome","Type":"Success"},{"Condition":"{{ ( or (eq .global.GetTerraformRunFinalState.output.RunState \"planned\") ( or  (eq .global.GetTerraformRunFinalState.output.RunState \"applying\") ( or (eq .global.GetTerraformRunFinalState.output.RunState \"apply_queued\") ( or (eq .global.GetTerraformRunFinalState.output.RunState \"plan_queued\" ) (eq .global.GetTerraformRunFinalState.output.RunState \"confirmed\") )))) }}","Message":"The Run ID \"{{ .global.task.input.RunId }}\" is being processed and is in \"{{.global.GetTerraformRunFinalState.output.RunState}}\" state.","ObjectType":"workflow.Outcome","Type":"Status"},{"Condition":"{{ ( or (eq .global.GetTerraformRunFinalState.output.RunState \"policy_checked\") ( or  (eq .global.GetTerraformRunFinalState.output.RunState \"cost_estimating\") ( or (eq .global.GetTerraformRunFinalState.output.RunState \"cost_estimated\") ( or (eq .global.GetTerraformRunFinalState.output.RunState \"policy_checking\") (eq .global.GetTerraformRunFinalState.output.RunState \"planning\") )))) }}","Message":"The Run ID \"{{ .global.task.input.RunId }}\" is being processed and is in \"{{.global.GetTerraformRunFinalState.output.RunState}}\" state.","ObjectType":"workflow.Outcome","Type":"Status"},{"Condition":"{{ ( or (eq .global.GetTerraformRunFinalState.output.RunState \"discarded\") ( or  (eq .global.GetTerraformRunFinalState.output.RunState \"errored\") ( or (eq .global.GetTerraformRunFinalState.output.RunState \"canceled\") ( or (eq .global.GetTerraformRunFinalState.output.RunState \"policy_soft_failed\") ( or (eq .global.GetTerraformRunFinalState.output.RunState \"pending\") (eq .global.GetTerraformRunFinalState.output.RunState \"force_canceled\") ))))) }}","Message":"The Run ID \"{{ .global.task.input.RunId }}\" is in \"{{.global.GetTerraformRunFinalState.output.RunState}}\" state.","ObjectType":"workflow.Outcome","Type":"TerminalError"},{"Condition":"{{ ne .global.GetTerraformRunFinalState.output.HttpStatusCode 200 }}","Message":"We are unable to retrieve the state due to an unexpected error. Do try again. \"{{.global.GetTerraformRunFinalState.output.HttpStatusMsg}}.\"","Type":"TerminalError"},{"Condition":"true","Message":"We are unable to retrieve the state due to an unexpected error. Do try again. \"{{.global.GetTerraformRunFinalState.output.RunState}}\".","Name":"FailureState","Type":"TerminalError"}],"Protocol":"https","ResponseSpec":{"ErrorParameters":[],"ObjectType":"content.Grammar","Parameters":[{"AcceptSingleValue":false,"ComplexType":"","ItemType":"simple","Name":"RunState","ObjectType":"content.Parameter","Path":"$.data.attributes.status","Secure":false,"Type":"simple"}],"Types":[]},"TargetType":"Endpoint","Url":"/api/v2/runs/{{.global.task.input.RunId}}"}],"ClassId":"workflow.BatchApiExecutor","Constraints":{"ObjectType":"workflow.TaskConstraints"},"Description":"Generic Batch API Task","Name":"GetTerraformRunFinalState","ObjectType":"workflow.BatchApiExecutor","Output":{"RunState":"{{.global.GetTerraformRunFinalState.output.RunState}}"},"RetryFromFailedApi":true,"SharedScope":"shared","TaskDefinition":{"ObjectType":"workflow.TaskDefinition","Selector":"Name eq \"GetTerraformRunState\" and Version eq 1"}},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/BatchApiExecutors","Verb":"POST"},{"Body":{"Batch":[{"ContentType":"json","EndpointRequestType":"Internal","Headers":"{\"Content-Type\": [\"application/vnd.api+json\"]}","Method":"GET","Name":"GetTerraformCurrentStateVersion","ObjectType":"workflow.WebApi","Outcomes":[{"Condition":"{{eq .global.GetTerraformCurrentStateVersion.output.HttpStatusCode 404}}","Message":"Either the Workspace ID \"{{.global.task.input.WorkspaceId}}\" does not exist or it does not have any states saved. Do try again by providing a valid Workspace ID with saved states.","ObjectType":"workflow.Outcome","Type":"Error"},{"Condition":"{{ne .global.GetTerraformCurrentStateVersion.output.HttpStatusCode 200}}","Message":"We are unable to fetch the current state version due to an unexpected error. Do try again. \"{{.global.GetTerraformCurrentStateVersion.output.HttpStatusMsg}}.\"","ObjectType":"workflow.Outcome","Type":"Error"},{"Condition":"{{eq .global.GetTerraformCurrentStateVersion.output.HttpStatusCode 200}}","Message":"We fetched the current state version for this Workspace \"{{.global.task.input.WorkspaceId}}\".","ObjectType":"workflow.Outcome","Type":"Success"}],"Protocol":"https","ResponseSpec":{"ErrorParameters":[],"ObjectType":"content.Grammar","Parameters":[{"AcceptSingleValue":false,"ComplexType":"","ItemType":"simple","Name":"CurrentStateVersion","ObjectType":"content.Parameter","Path":"$[\"data\"][\"attributes\"][\"hosted-state-download-url\"]","Secure":false,"Type":"simple"},{"AcceptSingleValue":false,"ComplexType":"","ItemType":"simple","Name":"StateVersionOutputs","ObjectType":"content.Parameter","Path":"$.data.relationships.outputs.data[*].id","Secure":false,"Type":"string"}],"Types":[]},"TargetType":"Endpoint","Url":"/api/v2/workspaces/{{.global.task.input.WorkspaceId}}/current-state-version"}],"ClassId":"workflow.BatchApiExecutor","Constraints":{"ObjectType":"workflow.TaskConstraints"},"Description":"API Task to fetch current state version of a workspace","Name":"GetTerraformCurrentStateVersion","ObjectType":"workflow.BatchApiExecutor","Output":{"CurrentStateVersion":"{{.global.GetTerraformCurrentStateVersion.output.CurrentStateVersion}}","StateVersionOutputs":"{{.global.GetTerraformCurrentStateVersion.output.StateVersionOutputs}}"},"SharedScope":"shared","TaskDefinition":{"ObjectType":"workflow.TaskDefinition","Selector":"Name eq \"GetTerraformCurrentStateVersion\" and Version eq 1"}},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/BatchApiExecutors","Verb":"POST"},{"Body":{"Batch":[{"Body":"{{- if index .global.task.input \"Body\" -}}\n  {{.global.task.input.Body.Text}}\n{{- end -}}","ContentType":"{{- if index .global.task.input \"ContentType\" -}}\n  {{.global.task.input.ContentType}}\n{{- else -}}json{{- end -}}","Cookies":"{{- if index .global.task.input \"Cookies\" -}}\n  {{.global.task.input.Cookies | ToJson}}\n{{- end -}}","EndpointRequestType":"Internal","Headers":"{{- if index .global.task.input \"Headers\" -}}\n  {{.global.task.input.Headers | ToJson}}\n{{- end -}}","Method":"{{- if index .global.task.input \"Method\" -}}\n  {{.global.task.input.Method}}\n{{- else -}}GET{{- end -}}","Name":"GenericBatchApiTask","ObjectType":"workflow.WebApi","Outcomes":"{{- if index .global.task.input \"Outcomes\" -}}\n  {{.global.task.input.Outcomes | ToJson}}\n{{- end -}}","Protocol":"{{- if index .global.task.input \"Protocol\" -}}\n  {{.global.task.input.Protocol}}\n{{- else -}}https{{- end -}}","ResponseSpec":"{{- if index .global.task.input \"ResponseParser\" -}}\n  {{.global.task.input.ResponseParser | ToJson}}\n{{- end -}}","TargetType":"{{- if index .global.task.input \"Target\" -}}\n  Endpoint\n{{- else -}}Local{{- end -}}","Url":"{{.global.task.input.Url}}"}],"ClassId":"workflow.BatchApiExecutor","Constraints":{"ObjectType":"workflow.TaskConstraints"},"Description":"Generic Batch API Task","Name":"GenericBatchApiTask","ObjectType":"workflow.BatchApiExecutor","Output":{"Cookies":"{{- if index .global.GenericBatchApiTask.output \"HttpCookies\" -}}\n  {{.global.GenericBatchApiTask.output.HttpCookies | ToJson}}\n{{- end -}}","Headers":"{{- if index .global.GenericBatchApiTask.output \"HttpHeaders\" -}}\n  {{.global.GenericBatchApiTask.output.HttpHeaders | ToJson}}\n{{- end -}}","Parameters":"{{.global.GenericBatchApiTask.output | ToJson}}","StatusCode":"{{- if index .global.GenericBatchApiTask.output \"HttpStatusCode\" -}}\n  {{.global.GenericBatchApiTask.output.HttpStatusCode}}\n{{- end -}}","StatusMessage":"{{- if index .global.GenericBatchApiTask.output \"HttpStatusMsg\" -}}\n  {{.global.GenericBatchApiTask.output.HttpStatusMsg}}\n{{- end -}}"},"SharedScope":"shared","TaskDefinition":{"ObjectType":"workflow.TaskDefinition","Selector":"Name eq \"InvokeGenericWebApi\" and Version eq 1"}},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/BatchApiExecutors","Verb":"POST"},{"Body":{"Batch":[{"ContentType":"json","EndpointRequestType":"Internal","Headers":"{\"Content-Type\": [\"application/vnd.api+json\"]}","Method":"GET","Name":"GetTerraformVariableId","ObjectType":"workflow.WebApi","Outcomes":[{"Condition":"{{ne .global.GetTerraformVariableId.output.HttpStatusCode 200}}","Message":"We could not fetch the variable ID for \"{{if index .global.task.input.TerraformVariable `Key`}}{{ .global.task.input.TerraformVariable.Key }}{{ end }}\" due to an unexpected error. Do try again. \"{{.global.GetTerraformVariableId.output.HttpStatusMsg}}.\" ","Name":"AnyFailure","Type":"Error"},{"Condition":"{{if not .global.GetTerraformVariableId.output.VariableId}}true{{else}}false{{end}}","Message":"The variable \"{{if index .global.task.input.TerraformVariable `Key`}}{{ .global.task.input.TerraformVariable.Key }}{{ end }}\" does not exist.Try again by providing the right variable name.","Name":"InvalidVariableName","Type":"Error"},{"Condition":"true","Message":"The Variable ID \"{{index .global.GetTerraformVariableId.output.VariableId 0}}\" is in use with the key \"{{if index .global.task.input.TerraformVariable `Key`}}{{ .global.task.input.TerraformVariable.Key }}{{ end }}\".","Name":"VariableExists","Type":"Success"}],"Protocol":"https","ResponseSpec":{"ErrorParameters":[],"ObjectType":"content.Grammar","Parameters":[{"AcceptSingleValue":false,"ComplexType":"","ItemType":"simple","Name":"VariableId","ObjectType":"content.Parameter","Path":"$[\"data\"][?(@.attributes.key==\"{{if index .global.task.input.TerraformVariable `Key`}}{{ .global.task.input.TerraformVariable.Key | TrimSpace}}{{end}}\")][\"id\"]","Secure":false,"Type":"simple"}],"Types":[]},"TargetType":"Endpoint","Url":"/api/v2/workspaces/{{.global.task.input.WorkspaceId}}/vars"}],"ClassId":"workflow.BatchApiExecutor","Constraints":{"ObjectType":"workflow.TaskConstraints"},"Description":"API Task to fetch a Terraform Variable","Name":"GetTerraformVariableId","ObjectType":"workflow.BatchApiExecutor","Output":{"VariableId":"{{index .global.GetTerraformVariableId.output.VariableId 0}}"},"SharedScope":"shared","TaskDefinition":{"ObjectType":"workflow.TaskDefinition","Selector":"Name eq \"GetTerraformVariableId\" and Version eq 1"}},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/BatchApiExecutors","Verb":"POST"},{"Body":{"Batch":[{"ContentType":"json","EndpointRequestType":"Internal","Headers":"{\"Content-Type\": [\"application/vnd.api+json\"]}","Method":"GET","Name":"GetTerraformSensitiveVariableId","ObjectType":"workflow.WebApi","Outcomes":[{"Condition":"{{ne .global.GetTerraformSensitiveVariableId.output.HttpStatusCode 200}}","Message":"We could not fetch the variable ID for \"{{if index .global.task.input.TerraformVariable `Key`}}{{ .global.task.input.TerraformVariable.Key }}{{ end }}\" due to an unexpected error. Do try again. \"{{.global.GetTerraformSensitiveVariableId.output.HttpStatusMsg}}.\"","Name":"AnyFailure","Type":"Error"},{"Condition":"{{if not .global.GetTerraformSensitiveVariableId.output.VariableId}}true{{else}}false{{end}}","Message":"The variable \"{{if index .global.task.input.TerraformVariable `Key`}}{{ .global.task.input.TerraformVariable.Key }}{{ end }}\" does not exist. Try again by providing the right variable name.","Name":"InvalidVariableName","Type":"Error"},{"Condition":"true","Message":"The Variable ID \"{{index .global.GetTerraformSensitiveVariableId.output.VariableId 0}}\" is in use with the key \"{{if index .global.task.input.TerraformVariable `Key`}}{{ .global.task.input.TerraformVariable.Key }}{{ end }}\".","Name":"VariableExists","Type":"Success"}],"Protocol":"https","ResponseSpec":{"ErrorParameters":[],"ObjectType":"content.Grammar","Parameters":[{"AcceptSingleValue":false,"ComplexType":"","ItemType":"simple","Name":"VariableId","ObjectType":"content.Parameter","Path":"$[\"data\"][?(@.attributes.key==\"{{if index .global.task.input.TerraformVariable `Key`}}{{ .global.task.input.TerraformVariable.Key | TrimSpace }}{{end}}\")][\"id\"]","Secure":false,"Type":"simple"}],"Types":[]},"TargetType":"Endpoint","Url":"/api/v2/workspaces/{{.global.task.input.WorkspaceId}}/vars"}],"ClassId":"workflow.BatchApiExecutor","Constraints":{"ObjectType":"workflow.TaskConstraints"},"Description":"API Task to fetch a Terraform Variable","Name":"GetTerraformSensitiveVariableId","ObjectType":"workflow.BatchApiExecutor","Output":{"VariableId":"{{index .global.GetTerraformSensitiveVariableId.output.VariableId 0}}"},"SharedScope":"shared","TaskDefinition":{"ObjectType":"workflow.TaskDefinition","Selector":"Name eq \"GetTerraformSensitiveVariableId\" and Version eq 1"}},"ClassId":"bulk.RestSubRequest","ObjectType":"bulk.RestSubRequest","TargetMoid":"","Uri":"/v1/workflow/BatchApiExecutors","Verb":"POST"}]